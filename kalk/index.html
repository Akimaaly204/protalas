<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AKIM.PRO ‚Äî –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ—Ç–æ-—Å–º–µ—Ç—ã -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–∞–Ω–Ω—ã—Ö -->
    <script src="data/prices.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; -webkit-tap-highlight-color: transparent; }
        .card { background: #111; border: 1px solid #222; border-radius: 20px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        input[type="number"] { background: #1a1a1a; border: 1px solid #333; color: #fff; width: 70px; height: 40px; border-radius: 10px; text-align: center; font-weight: bold; outline: none; }
        input[type="text"] { background: #111; border: 1px solid #222; padding: 15px; border-radius: 15px; width: 100%; color: white; outline: none; transition: 0.3s; }
        input[type="text"]:focus { border-color: #3b82f6; }
        .sticky-result { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); border-top: 1px solid #222; padding: 20px; z-index: 50; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ñ–æ—Ç–æ */
        #photo-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 100; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        #invoice-paper { background: white; color: #000; padding: 30px; width: 100%; max-width: 400px; border-radius: 5px; }
        .pdf-table { width: 100%; border-collapse: collapse; margin-top: 15px; color: #000; }
        .pdf-table th { text-align: left; font-size: 10px; text-transform: uppercase; border-bottom: 2px solid #000; padding: 5px; }
        .pdf-table td { font-size: 12px; padding: 8px 5px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body class="p-4 pb-48">

    <div class="max-w-md mx-auto">
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-2xl font-black italic text-blue-500 uppercase">AKIM.PRO</h1>
                <p class="text-[9px] font-bold text-gray-500 tracking-widest">ELECTRIC SPECIALIST</p>
            </div>
            <div class="text-right">
                <p class="text-sm font-black text-blue-400">+996 755 000 228</p>
            </div>
        </div>

        <!-- –ü–æ–ª–µ –∏–º–µ–Ω–∏ -->
        <div class="mb-8">
            <label class="text-[10px] font-black text-gray-500 uppercase ml-2 mb-2 block">–ò–º—è –∑–∞–∫–∞–∑—á–∏–∫–∞ / –û–±—ä–µ–∫—Ç</label>
            <input type="text" id="client_name" placeholder="–ù–∞–ø—Ä: —É–ª. –õ–µ–Ω–∏–Ω–∞ 45">
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—ã–≤–æ–¥–∞ —É—Å–ª—É–≥ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
        <div id="items_list"></div>
    </div>

    <!-- –§—É—Ç–µ—Ä -->
    <div class="sticky-result">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div>
                <p class="text-[10px] font-black text-gray-500 uppercase mb-1">–ò—Ç–æ–≥–æ:</p>
                <div class="text-3xl font-black italic text-blue-500"><span id="total_sum">0</span> <small class="text-xs not-italic text-white">—Å–æ–º</small></div>
            </div>
            <div class="flex gap-2">
                <button onclick="copyWhatsApp()" class="bg-green-600 w-12 h-12 rounded-xl flex items-center justify-center active:scale-90 transition shadow-lg shadow-green-900/20">
                    <i class="fab fa-whatsapp text-xl"></i>
                </button>
                <button onclick="generatePhoto()" class="bg-blue-600 px-6 h-12 rounded-xl font-black text-[11px] uppercase active:scale-95 transition shadow-lg shadow-blue-900/20">
                    –°–º–µ—Ç–∞ (–§–æ—Ç–æ)
                </button>
            </div>
        </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è —Ñ–æ—Ç–æ -->
    <div id="photo-overlay">
        <div id="image-result" class="mb-4 shadow-2xl border-4 border-white rounded-lg overflow-hidden max-h-[70vh]"></div>
        <p class="text-white text-[10px] font-bold uppercase mb-6 text-center opacity-70">–ó–∞–∂–º–∏ –ø–∞–ª—å—Ü–µ–º –Ω–∞ —Ñ–æ—Ç–æ,<br>—á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –≥–∞–ª–µ—Ä–µ—é</p>
        <button onclick="document.getElementById('photo-overlay').style.display='none'" class="bg-red-600 text-white px-10 py-3 rounded-full font-black text-xs uppercase">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–π –º–∞–∫–µ—Ç –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ -->
    <div style="position: absolute; left: -9999px;">
        <div id="invoice-paper">
            <div style="border-bottom: 4px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px;">
                <h2 style="margin: 0; font-size: 24px; font-weight: 900; color: #1e40af;">AKIM.PRO</h2>
                <p style="margin: 0; font-size: 10px; color: #666; text-transform: uppercase; letter-spacing: 1px;">–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã ‚Ä¢ –¢–∞–ª–∞—Å</p>
            </div>
            <div style="font-size: 11px; margin-bottom: 20px;">
                <p style="margin: 3px 0;"><strong>–ó–∞–∫–∞–∑—á–∏–∫:</strong> <span id="res_client"></span></p>
                <p style="margin: 3px 0;"><strong>–ú–∞—Å—Ç–µ—Ä:</strong> +996 755 000 228</p>
                <p style="margin: 3px 0;"><strong>–î–∞—Ç–∞:</strong> <span id="res_date"></span></p>
            </div>
            <table class="pdf-table">
                <thead>
                    <tr>
                        <th>–†–∞–±–æ—Ç–∞</th>
                        <th style="text-align: center;">–ö–æ–ª-–≤–æ</th>
                        <th style="text-align: right;">–°—É–º–º–∞</th>
                    </tr>
                </thead>
                <tbody id="res_rows"></tbody>
            </table>
            <div style="margin-top: 30px; text-align: right;">
                <div style="display: inline-block; background: #3b82f6; color: white; padding: 15px 25px; border-radius: 4px;">
                    <p style="margin: 0; font-size: 10px; text-transform: uppercase;">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</p>
                    <h3 style="margin: 0; font-size: 24px; font-weight: 900;"><span id="res_total">0</span> –°–û–ú</h3>
                </div>
            </div>
        </div>
    </div>

    <script>
        const itemsList = document.getElementById('items_list');
        const totalDisplay = document.getElementById('total_sum');

        // –†–µ–Ω–¥–µ—Ä –∏–∑ —Ç–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ data/prices.js
        function loadLibrary() {
            ESTIMATE_LIBRARY.forEach(cat => {
                let html = `<h3 class="text-[11px] font-black text-blue-500 uppercase mt-8 mb-3 ml-2 tracking-widest">${cat.category}</h3>`;
                cat.items.forEach(item => {
                    html += `
                        <div class="card shadow-sm">
                            <div class="pr-3">
                                <p class="text-[13px] font-bold uppercase leading-tight">${item.name}</p>
                                <p class="text-[10px] text-gray-600 font-bold mt-1">${item.price} —Å–æ–º</p>
                            </div>
                            <input type="number" data-price="${item.price}" data-name="${item.name}" value="0" min="0" 
                                   class="qty-input" inputmode="numeric" oninput="updateTotal()">
                        </div>
                    `;
                });
                itemsList.innerHTML += html;
            });
        }

        function updateTotal() {
            let total = 0;
            document.querySelectorAll('.qty-input').forEach(input => {
                total += (parseInt(input.value) || 0) * parseInt(input.dataset.price);
            });
            totalDisplay.innerText = total.toLocaleString();
        }

        async function generatePhoto() {
            const client = document.getElementById('client_name').value || "–ù–µ —É–∫–∞–∑–∞–Ω";
            document.getElementById('res_client').innerText = client;
            document.getElementById('res_date').innerText = new Date().toLocaleDateString('ru-RU');
            
            let rows = '';
            let total = 0;
            document.querySelectorAll('.qty-input').forEach(input => {
                const val = parseInt(input.value) || 0;
                if(val > 0) {
                    const price = parseInt(input.dataset.price);
                    const sub = val * price;
                    total += sub;
                    rows += `<tr><td>${input.dataset.name}</td><td style="text-align:center">${val}</td><td style="text-align:right">${sub.toLocaleString()}</td></tr>`;
                }
            });

            if(!rows) { alert('–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ!'); return; }

            document.getElementById('res_rows').innerHTML = rows;
            document.getElementById('res_total').innerText = total.toLocaleString();

            // –°–æ–∑–¥–∞–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç
            const canvas = await html2canvas(document.getElementById('invoice-paper'), { scale: 3 });
            const img = document.createElement('img');
            img.src = canvas.toDataURL("image/png");
            img.style.width = "100%";
            
            document.getElementById('image-result').innerHTML = '';
            document.getElementById('image-result').appendChild(img);
            document.getElementById('photo-overlay').style.display = 'flex';
        }

        function copyWhatsApp() {
            const client = document.getElementById('client_name').value || "–ö–ª–∏–µ–Ω—Ç";
            let msg = `‚ö° *–°–ú–ï–¢–ê AKIM.PRO*\nüë§ –û–±—ä–µ–∫—Ç: ${client}\n--------------------------\n`;
            
            document.querySelectorAll('.qty-input').forEach(input => {
                const val = parseInt(input.value) || 0;
                if(val > 0) {
                    msg += `‚Ä¢ ${input.dataset.name}: ${val} ‚Äî ${val * input.dataset.price} —Å–æ–º\n`;
                }
            });

            msg += `--------------------------\nüí∞ *–ò–¢–û–ì–û: ${totalDisplay.innerText} –°–û–ú*\n\nüìû –ú–∞—Å—Ç–µ—Ä: +996 755 000 228`;
            
            const area = document.createElement('textarea');
            area.value = msg;
            document.body.appendChild(area);
            area.select();
            document.execCommand('copy');
            document.body.removeChild(area);
            alert('–°–º–µ—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ—ë –≤ WhatsApp.');
        }

        loadLibrary();
    </script>
</body>
</html>

  
